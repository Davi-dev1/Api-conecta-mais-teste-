<!DOCTYPE html>
<html lang="pt">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conecta Mais</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
</head>

<body>
<!--olha como esse código é muito melhor
//h${title $}*3;<----->
   
    
    <div class="container">
        <header class="d-flex flex-wrap justify-content-center py-3 mb-4 border-bottom">
            <a href="/"
                class="d-flex align-items-center mb-3 mb-md-0 me-md-auto link-body-emphasis text-decoration-none">
                <svg class="bi me-2" width="40" height="32">
                    <use xlink:href="#bootstrap"></use>
                </svg>
                <span class="fs-4">Conecta Mais</span>
            </a>

            <ul class="nav nav-pills">
                <li class="nav-item"><a href="Home.html" class="nav-link active" aria-current="page">Home</a></li>
                <li class="nav-item"><a href="PostData.html" class="nav-link">Cadastrar</a></li>
                <li class="nav-item"><a href="GetData.html" class="nav-link">Listar</a></li>
                <li class="nav-item"><a href="GetParamData.html" class="nav-link">Buscar</a></li>
                <li class="nav-item"><a href="UpdateData.html" class="nav-link">Atualizar</a></li>
                <li class="nav-item"><a href="DeleteData.html" class="nav-link">Apagar</a></li>
                <li class="nav-item"><a href="Login.html" class="nav-link">Vagas</a></li>
            </ul>
        </header>
    </div>

    <div class="container">
        <div class="col-md-12 col-lg-12">
            <h4 class="mb-3">Listar todos os Usuários cadastrados </h4>
            <p class="mb-3">Consumindo a API da Conecta Mais utilizando FETCH</p>

            <div class="table-responsive">
                <table id="tabelaResposta" class="table-striped table">

                </table>
            </div>
        </div>
    </div>

    <script>
        //1 Coleta de Dados 
        // 2 Processamento de Dados
        // 3 Exibição de Dados 

        // O código abaixo consome a API da conecta mais para encontrar um único registro.

        // Tabela onde será exibido o resultado
        const tabelaResposta = document.getElementById("tabelaResposta");

        // URL da API
        const url = "http://localhost:8083/Usuarios/";

        // Esse modelo utiliza o comando fetch e trabalha com promessas. 
        fetch(url) // fetch significa pegar um determindo  metódo, ou seja  fetch é usado para fazer o javascript pgar dados lá do mysql, lembrando que o fetch é uma função em javascript não uma biblioteca
            .then(response => {
                return response.json();//sempre que usar o fetch precisa-se converter a resposta em json
            })
            .then(resposta => {
                console.log("Abaixo o resultado do consumo da API")
                console.log(resposta);// tanto o response quanto resposta vai receber valores da API

                // Exemplo dos dados exibidos em tela
                // innerHTML é uma propriedade que define o conteúdo HTML de um elemento
                tabelaResposta.innerHTML += `<thead>
                                                <tr><th>usuarioid</th><th>nome</th><th>email</th><th>telefone</th><th>senha</th><th>datadenascimento</th><th>cpf</th><th>rg</th><th>cep</th></tr>
                                             </thead>
                                            <tbody>
                                            <tr><td> ${resposta[0].usuarioid} </td><td> ${resposta[0].nome}</td><td> ${resposta[0].email}</td><td> ${resposta[0].telefone}</td><td> ${resposta[0].senha}</td><td> ${resposta[0].datadenascimento}</td><td> ${resposta[0].cpf}</td><td> ${resposta[0].rg}</td><td> ${resposta[0].cep}</td></tr>
                                              

                                               <tr><td> ${resposta[1].usuarioid} </td><td> ${resposta[1].nome}</td><td> ${resposta[1].email}</td><td> ${resposta[1].telefone}</td><td> ${resposta[1].senha}</td><td> ${resposta[1].datadenascimento}</td><td> ${resposta[1].cpf}</td><td> ${resposta[1].rg}</td><td> ${resposta[1].cep}</td></tr>

                                                 <tr><td> ${resposta[2].usuarioid} </td><td> ${resposta[2].nome}</td><td> ${resposta[2].email}</td><td> ${resposta[2].telefone}</td><td> ${resposta[2].senha}</td><td> ${resposta[2].datadenascimento}</td><td> ${resposta[2].cpf}</td><td> ${resposta[2].rg}</td><td> ${resposta[2].cep}</td></tr>

                                                   <tr><td> ${resposta[3].usuarioid} </td><td> ${resposta[3].nome}</td><td> ${resposta[3].email}</td><td> ${resposta[3].telefone}</td><td>${resposta[3].senha} </td><td> ${resposta[3].datadenascimento}</td><td> ${resposta[3].cpf}</td><td> ${resposta[3].rg}</td><td> ${resposta[3].cep}</td></tr> `;

                                                   for (let i = 0; i < resposta.length; i++) {
                                                    tabelaResposta.innerHTML += `
                                                        <tr>
                                                            <td>${resposta[i].usuarioid}</td>
                                                            <td>${resposta[i].nome}</td>
                                                            <td>${resposta[i].email}</td>
                                                            <td>${resposta[i].telefone}</td>
                                                            <td>******</td> <!-- Senha oculta por segurança -->
                                                            <td>${resposta[i].datadenascimento}</td>
                                                            <td>${resposta[i].cpf}</td>
                                                            <td>${resposta[i].rg}</td>
                                                            <td>${resposta[i].cep}</td>
                                                        </tr>
                                                    `;
                                                }
                                                
                                                // Fecha o tbody corretamente
                                                tabelaResposta.innerHTML += `</tbody>`;
                                    





                  //for(let i=0;i < 50;i++){
                    //tabelaResposta.innerHTML += '<tr><td> + resposta[i].usuario_id </td><td> + resposta[i].nome</td><td> +resposta[i].email</td><td> +resposta[i].telefone</td><td> + resposta[i].senha</td><td> + resposta[i].data_de_nascimento </td><td> + resposta[i].cpf </td><td> + resposta[i].rg</td><td> + resposta[i].cep</td></tr>';
                 //}
                 //tabelaResposta.innerHTML += "</tbody>";

// NA DÚVIDA SEMPRE UTILIZE ESSE '(TEMPLATE LITERAL) AO INVÉS DE ASPAS ANTES DA TAG  <TR>



              

                /*
                Você não dever construir uma tabela com operações innerHTML. É apenas uma operação de string, e o navegador NÃO terá nenhuma ideia de que você está adicionando várias linhas em sequência. Então, ele tentará "limpar" seu html "quebrado" adicionando tags de fechamento automaticamente. Isso pode resultar em um comportamento inesperado. Em vez disso, você deve criar elementos DOM e anexá-los ao DOM.

                Um exemplo de como fazer isso é:

                const table = document.createElement('table');
                const thead = document.createElement('thead');
                const tbody = document.createElement('tbody');
                const tr = document.createElement('tr');
                
                for (let i = 0; i < 50; i++) {
                                                
                    const td1 = document.createElement('td');
                    td1.textContent = resposta[i].nomeIndicado;
                    const td2 = document.createElement('td');
                    td2.textContent = resposta[i].categoria;
                    
                    const tr = document.createElement('tr');
                    tr.appendChild(td1);
                    tr.appendChild(td2);
                    
                    tbody.appendChild(tr);
                }

                table.appendChild(thead);
                table.appendChild(tbody);
                tabelaResposta.appendChild(table);
                
                */

            });
    </script>
    <!--CORS<----> 
<!---CROSS<---> 
<!--ORIGIN<---->
<!--RESOURCE
SHARING <---->
<!--ERROS QUE A API GERA PARA NÃO PERMITIR CONSULTAS DE OUTRAS APIS QUE VEM DO PRÓPRIO BROWSER
A OS @ LA DO INTELIJEA SÃO ANOTAÇÕES QUE PERMITEM REALIZAR CERTAS FUNÇÕES ATRAVÉS DE BIBLIOTECAS<---->



</body>

</html>